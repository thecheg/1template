"use strict";function scrollbarWidth(){var e=$('<div style="width:50px;height:50px;overflow:hidden;position:absolute;top:-200px;left:-200px;"><div style="height:100px;"></div>');$("body").append(e);var t=$("div",e).innerWidth();e.css("overflow-y","scroll");var o=$("div",e).innerWidth();return $(e).remove(),t-o}function defineBarWidth(){parseInt($(".page").width());var e=parseInt($(".page").height());scrollBarWidth=e>winHeight?scrollbarWidth():0}function scrollLock(e,t){"unlock"==t?e.removeClass("body--fixed").css({"padding-right":""}):e.addClass("body--fixed").css({"padding-right":scrollBarWidth})}function popup(e,t,o,i,a){if($("#"+e).length){popupOpenedPos=$(window).scrollTop(),$(".popups-overlay").addClass("active"),$("body").addClass("body--popup-opened"),scrollLock($("body")),$(".popup").removeClass("active");var s=$(".popup#"+e);if("request"==e){o?s.find(".popup-title__head").html(o):s.find(".popup-title__head").html("Оставить заявку"),i?s.find(".popup-title__subtitle").html(i):s.find(".popup-title__subtitle").html("Оставьте заявку, и&nbsp;наш специалист свяжется с&nbsp;вами в&nbsp;ближайшее время"),a?s.find(".btn").html(a):s.find(".btn--sendform").html("Оставить заявку"),t&&(formTitle=t)}s.scrollTop(0).addClass("active"),popupOpened=!0}}function videoPopup(e,t){if($("#"+e).length){popupOpenedPos=$(window).scrollTop(),$(".popups-overlay").addClass("active"),$("body").addClass("body--popup-opened"),scrollLock($("body")),$(".popup").removeClass("active");var o=$(".popup--video#"+e);o.find(".popup-video").html('<iframe src="'+t+'" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>'),o.scrollTop(0).addClass("active"),popupOpened=!0}}function popupClose(){$(".popups-overlay").removeClass("active"),$(".popup").removeClass("active"),$("body").removeClass("body--popup-opened"),setTimeout(function(){scrollLock($("body"),"unlock")},animDuration),device.ios()&&$(window).scrollTop(popupOpenedPos),$(".popup-video").html(""),$(".popup").find(".form-field").removeClass("form-field--error"),$(".popup").find(".form-field").find("input, textarea").val("").trigger("change"),popupOpened=!1}function thx(e){$(".popup").removeClass("active"),e||(e="thx"),popup(e),$("body").find(".form-field--error").removeClass("form-field--error"),$("body").find("textarea, input").val("").trigger("change")}function changeFormTitle(e){formTitle=e}function formValidator(e){var t=$(e),o=!0;if(t.find(".form-field--required").length&&t.find(".form-field--required").each(function(){var e,t="form-field--error",i=$(this).attr("data-field-type");if(e=$(this).find("input").length?$(this).find("input").val():$(this).find("textarea").val()){if($(this).removeClass(t),$(this).find(".form-errors__item--required").hide(),"email"==i){a="Неверный формат e-mail";/^[\.A-z0-9_\-\+]+[@][A-z0-9_\-]+([.][A-z0-9_\-]+)+[A-z]{1,4}$/.test(e)?($(this).find(".form-errors_item--type").remove(),$(this).removeClass(t)):($(this).find(".form-errors").append('<p class="form-errors__item--type">'+a+"</p>"),$(this).addClass(t),o=!1)}if("phone"==i){var a="Неверный формат номера телефона";/[^0-9\+ ()\-]/.test(e)?($(this).find(".form-errors").append('<p class="form-errors__item--type">'+a+"</p>"),$(this).addClass(t),o=!1):($(this).find(".form-errors__item--type").remove(),$(this).removeClass(t))}}else $(this).addClass(t),$(this).find(".form-errors__item--type").remove(),$(this).find(".form-errors__item--required").show(),o=!1}),1!=o)return!1}var winHeight,scrollOffset=60,popupOpened=!1,popupOpenedPos=0,scrollPos=0,animDuration=500,pageLoaded=!1,formTitle="";$(document).ready(function(){function e(e){return $('[data-scroll-section="'+e+'"]').first().offset().top-scrollOffset}function t(){var t=parseInt(.3*winHeight);i||o.each(function(o){var i=$(this),a=i.attr("data-scroll-section"),s=$('[data-scroll-link="'+a+'"].nav-scroll'),r=i.outerHeight(),n=e(a);scrollPos>n-t&&scrollPos<n+r-t?s.parent("li").addClass("active"):s.parent("li").removeClass("active")})}var o=$("[data-scroll-section]");svg4everybody(),serviceName&&(serviceName+=" – "),winHeight=$(window).height(),scrollPos=$(window).scrollTop(),$("img[data-src]").each(function(){var e=$(this);e.attr("src",e.attr("data-src")),e.on("load",function(){e.removeAttr("data-src")})}),device.desktop(),$(window).on("resize",function(){winHeight=$(window).height(),scrollPos=$(window).scrollTop(),scrollbarWidth(),defineBarWidth(),t()}),$(window).on("scroll",function(){scrollPos=$(window).scrollTop(),t()}),$(window).trigger("resize").trigger("scroll"),$(".form--validate").each(function(){var e=$(this);e.find(".form-field").each(function(){$(this).append('<div class="form-errors" />')}),e.find(".form-field--required").find(".form-errors").append('<p class="form-errors__item form-errors__item--required">Обязательное поле</p>')}),$(".form--validate").find(".form-field--required").each(function(){$(this).find(".input-placeholder").append(" *")}),$(".input").each(function(){var e=$(this),t=$(this).find("input, textarea"),o=$(this).closest(".form-field");t.on("focus",function(){e.addClass("active focused")}).on("focusout blur change keyup input",function(){""==$(this).val()?t.is(":focus")||e.removeClass("active"):(e.addClass("active"),o.removeClass("form-field--error"))}).on("focusout",function(){e.removeClass("focused")}),t.trigger("change")}),$(".form--enter").find("input").on("focus",function(){$(this).closest(".form--enter").addClass("focused")}).on("blur",function(){$(this).closest(".form--enter").removeClass("focused")}),$(".form--enter").find("input").on("focus",function(){var e=$(this).closest(".form--enter"),t=e.find(".btn--enter");$(document).keydown(function(o){e.hasClass("focused")&&13==o.which&&t.trigger("click")})}),$('input[type="number"]').on("input change paste keyup",function(){var e=parseInt($(this).attr("data-max")),t=$(this).val();t.length>e&&$(this).val(t.slice(0,e))}),$('input.input-phone_number, .form-validate .form-field[data-field-type="phone"] input').on("input change paste keyup",function(){$(this).val(this.value.replace(/[^0-9\+ ()\-]/,""))}),$(".scrollTo").on("click",function(e){e.preventDefault();var t=$(this).attr("data-scrollto");if(t){var o=$('[data-scrollto="'+t+'"]').not($(this)).offset().top-scrollOffset;$("html, body").animate({scrollTop:o},500)}}),$(".tab-content").hide(),$(".tabs").each(function(){($(this).find(".tab.active").length<1||$(this).find(".tab.active").length>1)&&($(this).find(".tab").removeClass("active"),$(this).find(".tab:first-child").addClass("active"));var e=$(this).find(".tab.active").find("a").attr("data-tab");$('.tab-content[data-tab="'+e+'"]').show()}),$(".tabs").find(".tab-link").on("click",function(){if(!$(this).closest(".tab").hasClass("active")){var e=$(this).attr("data-tab");$(this).closest(".tabs").find(".tab").removeClass("active"),$(this).closest(".tab").addClass("active"),$('.tab-content[data-tab="'+e+'"]').parent().find(".tab-content").hide(),$('.tab-content[data-tab="'+e+'"]').fadeIn(animDuration)}}),$(".accordion").each(function(){function e(e,i){var r=animDuration;if(s||(r=0),"open"==i){if(s){a.hide();var l=e.offset().top-scrollOffset-30;t.find(".accordion-item.active").find(".accordion-panel").show(),setTimeout(function(){$("html, body").animate({scrollTop:l},animDuration)},30)}if(setTimeout(function(){o.removeClass("active"),e.addClass("active"),a.slideUp(r),e.find(".accordion-panel").slideDown(r)},30),n){var d=t.attr("data-acc"),c=e.attr("data-acc-item"),p=$('[data-acc-con="'+d+'"]');p.find("[data-acc-con-item]").removeClass("active"),p.find('[data-acc-con-item="'+c+'"]').addClass("active")}}else e.removeClass("active"),a.slideUp(r);s||(s=!0)}var t=$(this),o=t.find(".accordion-item"),i=t.find(".accordion-trigger"),a=t.find(".accordion-panel"),s=!1,r=!0,n=!1;t.hasClass("not-collapsable")&&(r=!1),t.attr("data-acc")&&(n=!0),t.hasClass("collapsed")||e(!t.find(".accordion-item.active").length||t.find(".accordion-item.active").length>1?o.first():t.find(".accordion-item.active"),"open"),i.on("click",function(){var t=$(this).closest(".accordion-item");t.hasClass("active")?r&&e(t,"close"):e(t,"open")})}),$("iframe").each(function(){var e=$(this).attr("src"),t="wmode=transparent";if(-1!=e.indexOf("?")){var o=e.split("?"),i=o[1],a=o[0];$(this).attr("src",a+"?"+t+"&"+i)}else $(this).attr("src",e+"?"+t)}),$(".popup-content").each(function(){$(this).prepend('<div class="popup-close noselect" />')}),$(".popup-close").on("click",function(){popupClose()}),$(".popup").on("click",function(e){$(e.target).closest(".popup-content").length||(popupClose(),e.stopPropagation())}),$(document).on("keypress",function(e){(popupOpened=!0)&&27==e.which&&popupClose()}),$(".btn--sendform").on("click",function(e){e.preventDefault();var t=$(this),o=$(this).closest("form"),i=formValidator(o.get(0)),a=$(this).attr("data-form-type");if(0!=i){var s=new FormData(o.get(0)),r=t.attr("data-thxpopup")||"thx";formTitle=formTitle?serviceName+formTitle:serviceName+"Заявка",s.append("formTitle",formTitle),s.append("submit",a),$.ajax({type:"POST",url:rootPath+"php/send.php",dataType:"json",processData:!1,contentType:!1,data:s,success:function(){thx(r)},error:function(){console.log(data)}})}else o.find(".form-field-error").first().find("input, textarea").focus()});var i=!1;$(".nav-scroll[data-scroll-link]").on("click",function(t){var o=$(this).attr("data-scroll-link"),a=0;$('[data-scroll-section="'+o+'"]').length&&($(".nav-scroll[data-scroll-link]").closest("li").removeClass("active"),$('.nav-scroll[data-scroll-link="'+o+'"]').closest("li").addClass("active"),i=!0,a=e(o),$("html, body").animate({scrollTop:a},700,function(){i=!1}),$("body").removeClass("body--popuped body--menu-opened")),t.preventDefault()})}),$(window).on("load",function(){setTimeout(function(){$(".preloader").fadeOut(1e3,function(){$(this).remove()}),$("body").addClass("body--page-loaded"),pageLoaded=!0,$(window).trigger("scroll")},1e3)});var scrollBarWidth=0;