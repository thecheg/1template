"use strict";function popup(t,e,i,o,a){popupedPos=$(window).scrollTop(),$("html").addClass("html--popuped"),$(".popups-overlay").fadeIn(animDuration),$(".popup").removeClass("active").fadeOut(animDuration);var s=$(".popup#"+t);if("request"==t){i?s.find(".popup_h1").html(i):s.find(".popup_h1").html("Оставить заявку"),o?s.find(".popup_h2").html(o):s.find(".popup_h2").html("Оставьте заявку, и&nbsp;наш специалист свяжется с&nbsp;вами в&nbsp;ближайшее время"),a?s.find(".btn").html(a):s.find(".btn").html("Оставить заявку"),e&&(formTitle=e)}s.addClass("active").fadeIn(animDuration).scrollTop(0),popuped=!0}function videoPopup(t,e){popupedPos=$(window).scrollTop(),$("html").addClass("html--popuped"),$(".popups-overlay").fadeIn(animDuration),$(".popup").removeClass("active").fadeOut(animDuration);var i=$(".popup--video#"+t);i.find(".popup_video").html('<iframe src="'+e+'" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>'),i.addClass("active").fadeIn(animDuration).scrollTop(0),popuped=!0}function popupClose(){$(".popups-overlay").fadeOut(animDuration),$(".popup").removeClass("active").fadeOut(animDuration,function(){$("html").removeClass("html--popuped")}),device.ios()&&$(window).scrollTop(popupedPos),$(".popup_video").html(""),$(".popup").find(".form__field").removeClass("form__field--error"),$(".popup").find(".form__field").find("input, textarea").val("").trigger("change"),popuped=!1}function thx(t){$(".popup").removeClass("active").fadeOut(animDuration),t||(t="thx"),popup(t),$("body").find(".form__field--error").removeClass("form__field--error"),$("body").find("textarea, input").val("").trigger("change")}function changeFormTitle(t){formTitle=t}function formValidator(t){var e=$(t),i=!0;if(e.find(".form__field--required").length&&e.find(".form__field--required").each(function(){var t,e="form__field--error",o=$(this).attr("data-field-type");if(t=$(this).find("input").length?$(this).find("input").val():$(this).find("textarea").val()){if($(this).removeClass(e),$(this).find(".form-errors__item--required").hide(),"email"==o){a="Неверный формат e-mail";/^[\.A-z0-9_\-\+]+[@][A-z0-9_\-]+([.][A-z0-9_\-]+)+[A-z]{1,4}$/.test(t)?($(this).find(".form-errors_item--type").remove(),$(this).removeClass(e)):($(this).find(".form-errors").append('<p class="form-errors__item--type">'+a+"</p>"),$(this).addClass(e),i=!1)}if("phone"==o){var a="Неверный формат номера телефона";/[^0-9\+ ()\-]/.test(t)?($(this).find(".form-errors").append('<p class="form-errors__item--type">'+a+"</p>"),$(this).addClass(e),i=!1):($(this).find(".form-errors__item--type").remove(),$(this).removeClass(e))}}else $(this).addClass(e),$(this).find(".form-errors__item--type").remove(),$(this).find(".form-errors__item--required").show(),i=!1}),1!=i)return!1}var winWidth,winHeight,scrollOffset,popuped=!1,scrollPos=0,animDuration=400,offsetElem=$("header"),popupedPos,formTitle="";$(document).ready(function(){function t(){offsetElem.hasClass("hidden")?offsetElem.hasClass("hidden")&&(scrollOffset=0):scrollOffset=offsetElem.outerHeight()}function e(t,e){var i=t.indexOf(e);i=(t=t.slice(i,t.length)).indexOf(e);var o=t.indexOf("&");o<0&&(o=t.length);var a=t.slice(i+4,o);return d=t.slice(o+1,t.length),a}function i(t){var e=t.attr("href");return $(e).offset().top-scrollOffset}function o(t){var e,o=parseInt($(window).height()/3);for(e=0;e<u.length;e++){var a=$(u[e]),s=i(a);t>s-o&&t<s+o?(u.parent("li").removeClass("active"),a.parent("li").addClass("active")):u.parent("li").removeClass("active")}}if(svg4everybody(),$(".preloader").fadeOut(animDuration,function(){$(this).remove()}),$("a.fancybox").fancybox(),serviceName&&(serviceName+=" – "),winWidth=$(window).width(),winHeight=$(window).height(),scrollPos=$(window).scrollTop(),t(),$("img[data-src]").each(function(){var t=$(this);t.attr("src",t.attr("data-src")),t.on("load",function(){t.removeAttr("data-src")})}),$(window).resize(function(){winWidth=$(window).width(),winHeight=$(window).height(),scrollPos=$(window).scrollTop(),t()}),$(window).scroll(function(){scrollPos=$(window).scrollTop(),t()}),device.desktop());else{var a=scrollPos;$(window).scroll(function(){s()});function s(){$("body").hasClass("body--menu-opened")||(scrollPos>a?offsetElem.addClass("hidden"):scrollPos<a&&offsetElem.removeClass("hidden")),a=scrollPos}}$(".form--validate").each(function(){var t=$(this);t.find(".form__field").each(function(){$(this).append('<div class="form-errors" />')}),t.find(".form__field--required").find(".form-errors").append('<p class="form-errors__item form-errors__item-required">Обязательное поле</p>')}),$(".form--validate").find(".form__field--required").each(function(){$(this).find(".placeholder").append(" *")}),$(".label--input").each(function(){var t=$(this),e=$(this).find("input, textarea"),i=$(this).closest(".form__field");e.on("focus",function(){t.addClass("active focused")}).on("focusout blur change keyup input",function(){""==$(this).val()?e.is(":focus")||t.removeClass("active"):(t.addClass("active"),i.removeClass("form__field--error"))}).on("focusout",function(){t.removeClass("focused")})}),$(".form--enter").find("input").on("focus",function(){$(this).closest(".form--enter").addClass("focused")}).on("blur",function(){$(this).closest(".form--enter").removeClass("focused")}),$(".form--enter").find("input").on("focus",function(){var t=$(this).closest(".form--enter"),e=t.find(".btn--enter");$(document).keydown(function(i){t.hasClass("focused")&&13==i.which&&e.trigger("click")})}),$('input[type="number"]').on("input change paste keyup",function(){var t=parseInt($(this).attr("data-max")),e=$(this).val();e.length>t&&$(this).val(e.slice(0,t))}),$('input.input-phone_number, .form-validate .form__field[data-field-type="phone"] input').on("input change paste keyup",function(){$(this).val(this.value.replace(/[^0-9\+ ()\-]/,""))}),$(".scrollTo").on("click",function(t){t.preventDefault();var e=$(this).attr("data-scrollto");if(e){var i=$('[data-scrollto="'+e+'"]').not($(this)).offset().top-scrollOffset;$("html, body").animate({scrollTop:i},500)}}),$(".custom-select").each(function(){var t=$(this),e=t.attr("data-select-title");t.wrap('<div class="select" />');var i=$(this).closest(".select");t.css({position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%",opacity:"0","z-index":"-1"}),!1===device.desktop()&&t.css({"z-index":"3"}),i.append('<div class="trigger">'+e+"</div>").append('<ul class="options" />');var o=i.find(".trigger"),a=i.find("ul.options");!1===device.desktop()&&a.css({visibility:"hidden"});var s=1;t.find("option").each(function(){var t="",e=$(this).text(),o=$(this).val();$(this).attr("data-option",s),$.map(this.attributes,function(e){t=t+" "+e.name+'="'+e.value+'"'}),i.find("ul.options").append('<li data-value="'+o+'" '+t+'">'+e+"</li>"),i.find("ul.options").find('li[data-value="'+o+'"]').removeAttr("value"),s++}),o.on("click touch",function(){var t=$(this).outerHeight(),e=i.offset().top,o=a.outerHeight();$(".wrapper").outerHeight();i.hasClass("active")?i.removeClass("active"):(e+t+o+20>$(window).height()+$(window).scrollTop()?i.addClass("overflowing"):i.removeClass("overflowing"),i.addClass("active"))}),a.find("li").on("click",function(){if(!$(this).hasClass("selected")){var e=$(this).attr("data-option"),a=$(this).text();o.text(a),i.addClass("filled"),i.find("li").removeClass("selected"),$(this).addClass("selected"),i.removeClass("active"),t.find("option:selected").each(function(){this.selected=!1}),t.find('option[data-option="'+e+'"]').attr("selected","selected"),i.addClass("chosen")}i.hasClass("with-input")&&i.find("input").val(a)}),t.on("change",function(){var t=$(this).find("option:selected").attr("data-option");a.find('li[data-option="'+t+'"]').trigger("click")})});var n=document.location.href.split("?params!")[1]||"",r=(n.match(/tab=/g)||[]).length,l=(n.match(/acc=/g)||[]).length;if(r>0)for(var d=n,c=0;c<r;c++){var f=e(d,"tab="),p=$("ul.tabs").find('a[data-tab="'+f+'"]');p.closest("ul.tabs").find("li").removeClass("active"),p.closest("li").addClass("active")}$(".tab-content").hide(),$("ul.tabs").each(function(){($(this).find("li.active").length<1||$(this).find("li.active").length>1)&&($(this).find("li").removeClass("active"),$(this).find("li:first-child").addClass("active"));var t=$(this).find("li.active").find("a").attr("data-tab");$('.tab-content[data-tab="'+t+'"]').show()}),$("ul.tabs").find("a").on("click",function(){if(!$(this).closest("li").hasClass("active")){var t=$(this).attr("data-tab");$(this).closest("ul").find("li").removeClass("active"),$(this).closest("li").addClass("active"),$('.tab-content[data-tab="'+t+'"]').parent().find(".tab-content").hide(),$('.tab-content[data-tab="'+t+'"]').fadeIn(animDuration)}}),l>0&&setTimeout(function(){for(var t=n,i=0;i<l;i++){var o=e(t,"acc="),a=o.indexOf("(scroll)");-1!=a&&(o=o.slice(0,a)),$("ul.accordion").find('li[data-acc="'+o+'"]').find("h6").trigger("click")}},200),$("ul.accordion").not(".collapsed").each(function(){($(this).find("li.active").length<1||$(this).find("li.active").length>1)&&($(this).find("li").removeClass("active"),$(this).find("li").first().addClass("active"))}),$("ul.accordion").find("li").not(".active").each(function(){$(this).find(".panel").hide()}),$("ul.accordion").find("li").find("h6").on("click",function(){var t=$(this).closest("li"),e=$(this).closest("ul").find("li");if(t.hasClass("active"))t.removeClass("active"),e.find(".panel").slideUp(animDuration);else{$(this).closest("ul.accordion").find(".panel").hide();var i=t.offset().top-scrollOffset;$(this).closest("ul.accordion").find("li.active").find(".panel").show(),setTimeout(function(){$("html, body").animate({scrollTop:i},animDuration),e.removeClass("active"),t.addClass("active"),e.find(".panel").slideUp(animDuration),t.find(".panel").slideDown(animDuration)},1)}}),$(document).mouseup(function(t){var e=$(".select.active, .dropdown.active");e.is(t.target)||0!==e.has(t.target).length||e.removeClass("active")}),$("iframe").each(function(){var t=$(this).attr("src"),e="wmode=transparent";if(-1!=t.indexOf("?")){var i=t.split("?"),o=i[1],a=i[0];$(this).attr("src",a+"?"+e+"&"+o)}else $(this).attr("src",t+"?"+e)}),$(".popup__content").each(function(){$(this).prepend('<div class="popup__close noselect" />')}),$(".popup__close").on("click",function(){popupClose()}),$(".popup").on("click",function(t){$(t.target).closest(".popup__content").length||(popupClose(),t.stopPropagation())}),$(document).keydown(function(t){(popuped=!0)&&27==t.which&&popupClose()}),$(".btn--sendform").on("click",function(){var t=$(this),e=$(this).closest("form"),i=formValidator(e.get(0)),o=$(this).attr("data-form-type");if(0!=i){var a=new FormData(e.get(0)),s=t.attr("data-thxpopup")||"thx";formTitle||(formTitle="Заявка"),a.append("formTitle",formTitle),a.append("submit",o),$.ajax({type:"POST",url:rootPath+"php/send.php",dataType:"json",processData:!1,contentType:!1,data:a,success:function(){thx(s)},error:function(){console.log(data)}})}else e.find(".form__field-error").first().find("input, textarea").focus()}),$('a[href^="#"].navScroll').click(function(t){var e=i($(this));$("html, body").animate({scrollTop:e},500),t.preventDefault()});var u=$('a[href^="#"].navScroll');o($(window).scrollTop()),$(window).scroll(function(t){o($(window).scrollTop())})});