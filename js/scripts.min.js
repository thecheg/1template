"use strict";var winHeight,scrollOffset=60,popupOpened=!1,popupOpenedPos=0,scrollPos=0,animDuration=200,pageLoaded=!1,formTitle="",scrollFixedEl=$("body");function vhFix(){$("body").append('<div class="vh-fix" style="position:fixed;width:1px;left:-9999px;top:0;bottom:0;pointer-events:none;opacity:0;visibility:hidden;" />');var e=.01*$(".vh-fix").height();document.documentElement.style.setProperty("--vh",e+"px"),$(".vh-fix").remove()}function tabsInit(e){(e.find(".ui-tab.active").length<1||1<e.find(".ui-tab.active").length)&&(e.find(".ui-tab").removeClass("active"),e.find(".ui-tab:first-child").addClass("active"));var o=e.find(".ui-tab.active").find(".ui-tab-link").attr("data-tab");$('.ui-tab-content[data-tab="'+o+'"]').show(),e.find(".ui-tab-link").on("click",function(){var e,o=$(this);o.closest(".ui-tab").hasClass("active")||(e=o.attr("data-tab"),o.closest(".ui-tabs").find(".ui-tab").removeClass("active"),o.closest(".ui-tab").addClass("active"),$('.ui-tab-content[data-tab="'+e+'"]').closest(".ui-tab-container").find(".ui-tab-content").removeClass("active"),$('.ui-tab-content[data-tab="'+e+'"]').addClass("active"))}),e.data("init",!0)}function accordionInit(r){var l=r.find(".ui-accordion-item"),e=r.find(".ui-accordion-trigger"),d=r.find(".ui-accordion-panel"),c=!1,o=!0,p=!1;function t(e,o){var t,i,n,a,s=c?animDuration:0;"open"==o?(c&&(d.hide(),t=e.offset().top-scrollOffset-30,r.find(".ui-accordion-item.active").find(".ui-accordion-panel").show(),setTimeout(function(){$("html, body").animate({scrollTop:t},animDuration)},30)),setTimeout(function(){l.removeClass("active"),e.addClass("active"),d.slideUp(s),e.find(".ui-accordion-panel").slideDown(s)},30),p&&(i=r.attr("data-acc"),n=e.attr("data-acc-item"),(a=$('[data-acc-con="'+i+'"]')).find("[data-acc-con-item]").removeClass("active"),a.find('[data-acc-con-item="'+n+'"]').addClass("active"))):(e.removeClass("active"),d.slideUp(s)),c=c||!0}r.hasClass("not-collapsable")&&(o=!1),r.attr("data-acc")&&(p=!0),r.hasClass("collapsed")||t(!r.find(".ui-accordion-item.active").length||1<r.find(".ui-accordion-item.active").length?l.first():r.find(".ui-accordion-item.active"),"open"),e.on("click",function(){var e=$(this).closest(".ui-accordion-item");e.hasClass("active")?o&&t(e,"close"):t(e,"open")}),r.data("init",!0)}function formInit(n){n.find(".ui-form-field--required").each(function(){$(this).append('<div class="ui-form-errors"><p class="ui-form-errors__item ui-form-errors__item--required">Обязательное поле</p></div>')}),n.find(".ui-form-field--required").each(function(){$(this).find(".ui-input-placeholder").append(" *")}),n.on("submit",function(e){e.preventDefault();var o,t,i=n.attr("data-form-type");formValidator(n.get(0))?(o=new FormData(n.get(0)),t=n.attr("data-thxpopup")||"thx",formTitle&&""!=formTitle||(formTitle="Заявка"),o.append("formTitle",formTitle),o.append("formType",i),$.ajax({type:"POST",url:rootPath+"php/send.php",dataType:"json",processData:!1,contentType:!1,data:o,success:function(){thx(t),clearForm(n)},error:function(e){console.log(e)}})):n.find(".ui-form-field--error").first().find("input, textarea").focus()}),n.data("init",!0)}function popupsInit(e){e.find(".popup-close-container").prepend('<div class="cross-btn popup-close noselect" />'),e.data("init",!0)}function inputInit(e){var o=e.find("input, textarea"),t=e.closest(".ui-form-field");o.on("focus",function(){e.addClass("active focused")}).on("focusout blur change keyup input",function(){""===$(this).val()?o.is(":focus")||e.removeClass("active"):(e.addClass("active"),t.removeClass("ui-form-field--error"))}).on("focusout",function(){e.removeClass("focused")}),o.trigger("change"),e.data("init",!0)}function imgInit(){$("img[data-src]").each(function(){var e=$(this);e.attr("src",e.attr("data-src")),e.on("load",function(){e.removeAttr("data-src")})})}function collapseInit(e){var o="ui-collapse",t=e.find("."+o+"-hidden"),i=e.find("."+o+"-trigger"),n=i.find("."+o+"-trigger-text"),a=i.attr("data-closed-text"),s=i.attr("data-opened-text");n.text(a),i.on("click",function(){e.hasClass("active")?(e.removeClass("active"),t.slideUp(400),n.text(a)):(e.addClass("active"),t.slideDown(400),n.text(s))})}function init(){imgInit(),$(".ui-tabs").each(function(){!0!==$(this).data("init")&&tabsInit($(this))}),$(".ui-accordion").each(function(){!0!==$(this).data("init")&&accordionInit($(this))}),$(".popup").each(function(){!0!==$(this).data("init")&&popupsInit($(this))}),$(".ui-input").each(function(){!0!==$(this).data("init")&&inputInit($(this))}),$(".send-form").each(function(){!0!==$(this).data("init")&&formInit($(this))}),$(".ui-collapse").each(function(){!0!==$(this).data("init")&&collapseInit($(this))})}svg4everybody(),$(document).ready(function(){"ontouchstart"in document.documentElement?$("html").addClass("touch"):$("html").addClass("no-touch");var e=$("[data-scroll-section]");winHeight=$(window).height(),scrollPos=$(window).scrollTop(),init(),$(document).on("click",".menu-toggle",function(){(menuOpened?menuClose:menuOpen)()}),device.desktop(),$(window).on("resize",function(){winHeight=$(window).height(),scrollPos=$(window).scrollTop(),scrollbarWidth(),defineBarWidth(),o(),vhFix(),menuOpened&&menuClose()}),$(window).on("scroll",function(){scrollPos=$(window).scrollTop(),o()}),$(window).trigger("resize").trigger("scroll"),$(document).on("input change paste keyup",'input.phone-number, .send-form .ui-form-field[data-field-type="phone"] input',function(){$(this).val(this.value.replace(/[^0-9\+ ()\-]/,""))}),$(document).on("click",".scrollTo",function(e){e.preventDefault();var o,t=$(this).attr("data-scrollto-link");t&&(o=$('[data-scrollto-target="'+t+'"]').not($(this)).offset().top-scrollOffset,$("html, body").animate({scrollTop:o},500))}),$(document).on("click","[data-popup-open]",function(){popup($(this).attr("data-popup-open"))}),$(document).on("click",".popup-close",function(){popupClose()}),$(document).on("click",".popup",function(e){$(e.target).closest(".popup-content").length||(popupClose(),e.stopPropagation())}),$(document).on("keypress",function(e){popupOpened&&27==e.which&&popupClose()});var i=!1;function s(e){return $('[data-scroll-section="'+e+'"]').first().offset().top-scrollOffset}function o(){var a=parseInt(.3*winHeight);i||e.each(function(){var e=$(this),o=e.attr("data-scroll-section"),t=$('[data-scroll-link="'+o+'"].nav-scroll'),i=e.outerHeight(),n=s(o);n-a<scrollPos&&scrollPos<n+i-a?t.parent("li").addClass("active"):t.parent("li").removeClass("active")})}$(".nav-scroll[data-scroll-link]").on("click",function(e){var o,t=$(this).attr("data-scroll-link");$('[data-scroll-section="'+t+'"]').length&&(menuOpened=!1,scrollLock(scrollFixedEl,"unlock"),$(".nav-scroll[data-scroll-link]").closest("li").removeClass("active"),$('.nav-scroll[data-scroll-link="'+t+'"]').closest("li").addClass("active"),i=!0,o=s(t),$("html, body").animate({scrollTop:o},700,function(){i=!1})),e.preventDefault()})}),$(window).on("load",function(){setTimeout(function(){$(".preloader").fadeOut(1e3,function(){$(this).remove()}),$("body").addClass("body--page-loaded"),pageLoaded=!0,$(window).trigger("scroll")},300)});var scrollBarWidth=0;function scrollbarWidth(){var e=$('<div style="width:50px;height:50px;overflow:hidden;position:absolute;top:-200px;left:-200px;"><div style="height:100px;"></div>');$("body").append(e);var o=$("div",e).innerWidth();e.css("overflow-y","scroll");var t=$("div",e).innerWidth();return $(e).remove(),o-t}function defineBarWidth(){var e=parseInt($(".page").height());scrollBarWidth=winHeight<e?scrollbarWidth():0}function scrollLock(e,o){"unlock"==o?($("body").removeClass("body--fixed"),e.css({"padding-right":""})):($("body").addClass("body--fixed"),e.css({"padding-right":scrollBarWidth}))}var menuOpened=!1;function menuOpen(){popupOpenedPos=$(window).scrollTop(),$("body").addClass("body--menu-opened"),scrollLock(scrollFixedEl),menuOpened=!0}function menuClose(){$("body").removeClass("body--menu-opened"),scrollLock(scrollFixedEl,"unlock"),device.ios()&&$(window).scrollTop(popupOpenedPos),menuOpened=!1}function popup(e,o,t,i,n){var a;$("#"+e).length&&(popupOpenedPos=$(window).scrollTop(),$(".popups-overlay").addClass("active"),$("body").addClass("body--popup-opened"),scrollLock(scrollFixedEl),$(".popup").removeClass("active"),a=$(".popup#"+e),"request"==e&&(t?a.find(".popup-title__head").html(t):a.find(".popup-title__head").html("Оставить заявку"),i?a.find(".popup-title__subtitle").html(i):a.find(".popup-title__subtitle").html("Оставьте заявку, и&nbsp;наш специалист свяжется с&nbsp;вами в&nbsp;ближайшее время"),n?a.find(".ui-btn--sendform").html(n):a.find(".ui-btn--sendform").html("Оставить заявку"),o&&(formTitle=o)),a.scrollTop(0).addClass("active"),popupOpened=!0)}function videoPopup(e,o){var t;$("#"+e).length&&(popupOpenedPos=$(window).scrollTop(),$(".popups-overlay").addClass("active"),$("body").addClass("body--popup-opened"),scrollLock(scrollFixedEl),$(".popup").removeClass("active"),(t=$(".popup#"+e)).find(".popup-video").html('<iframe src="'+o+'" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>'),t.scrollTop(0).addClass("active"),popupOpened=!0)}function popupClose(){$(".popups-overlay").removeClass("active"),$(".popup").removeClass("active"),$("body").removeClass("body--popup-opened"),setTimeout(function(){scrollLock(scrollFixedEl,"unlock")},animDuration),device.ios()&&$(window).scrollTop(popupOpenedPos),$(".popup-video").html(""),$(".popup .send-form").each(function(){clearForm($(this))}),popupOpened=!1}function thx(e){$(".popup").removeClass("active"),popup(e=e||"thx"),$(".popup .send-form").each(function(){clearForm($(this))})}function changeFormTitle(e){formTitle=e}function clearForm(e){e.find(".ui-form-field--error").removeClass(".ui-form-field--error"),e.find(".ui-form-field").find("input, textarea").val("").trigger("change")}function formValidator(e){var o=$(e),i="ui-form-field--error",n="",a=!0;return o.find(".ui-form-field--required").length&&o.find(".ui-form-field--required").each(function(){var e=$(this),o=e.attr("data-field-type"),t=e.find("input").length?e.find("input").val():e.find("textarea").val();e.find(".form-errors__item--type").remove(),t?(e.removeClass(i),e.find(".ui-form-errors__item--required").hide(),"email"==o&&(n="Неверный формат e-mail",/^([a-z0-9_\.-])+@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/i.test(t)?(e.find(".ui-form-errors_item--type").remove(),e.removeClass(i)):(e.find(".ui-form-errors").append('<p class="ui-form-errors__item--type">'+n+"</p>"),e.addClass(i),a=!1)),"phone"==o&&(n="Неверный формат телефона",/[^0-9\+ ()\-]/.test(t)?($(this).find(".ui-form-errors").append('<p class="ui-form-errors__item--type">'+n+"</p>"),e.addClass(i),a=!1):(e.find(".ui-form-errors__item--type").remove(),e.removeClass(i)))):(e.addClass(i),e.find(".ui-form-errors__item--type").remove(),e.find(".ui-form-errors__item--required").show(),a=!1)}),a}