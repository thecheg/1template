"use strict";function vhFix(){$("body").append('<div class="vh-fix" style="position:fixed;width:1px;left:-9999px;top:0;bottom:0;pointer-events:none;opacity:0;visibility:hidden;" />');var e=.01*$(".vh-fix").height();document.documentElement.style.setProperty("--vh",e+"px"),$(".vh-fix").remove()}function tabsInit(e){(e.find(".ui-tab.active").length<1||e.find(".ui-tab.active").length>1)&&(e.find(".ui-tab").removeClass("active"),e.find(".ui-tab:first-child").addClass("active"));var o=e.find(".ui-tab.active"),t=o.find(".ui-tab-link").attr("data-tab");$('.ui-tab-content[data-tab="'+t+'"]').show(),e.find(".ui-tab-link").on("click",function(){var e=$(this);if(!e.closest(".ui-tab").hasClass("active")){var o=e.attr("data-tab");e.closest(".ui-tabs").find(".ui-tab").removeClass("active"),e.closest(".ui-tab").addClass("active"),$('.ui-tab-content[data-tab="'+o+'"]').closest(".ui-tab-container").find(".ui-tab-content").removeClass("active"),$('.ui-tab-content[data-tab="'+o+'"]').addClass("active")}}),e.data("init",!0)}function accordionInit(e){function o(o,t){var n=animDuration;if(s||(n=0),"open"==t){if(s){a.hide();var r=o.offset().top-scrollOffset-30;e.find(".ui-accordion-item.active").find(".ui-accordion-panel").show(),setTimeout(function(){$("html, body").animate({scrollTop:r},animDuration)},30)}if(setTimeout(function(){i.removeClass("active"),o.addClass("active"),a.slideUp(n),o.find(".ui-accordion-panel").slideDown(n)},30),l){var d=e.attr("data-acc"),c=o.attr("data-acc-item"),p=$('[data-acc-con="'+d+'"]'),u=p.find("[data-acc-con-item]");u.removeClass("active"),p.find('[data-acc-con-item="'+c+'"]').addClass("active")}}else o.removeClass("active"),a.slideUp(n);s||(s=!0)}var t,i=e.find(".ui-accordion-item"),n=e.find(".ui-accordion-trigger"),a=e.find(".ui-accordion-panel"),s=!1,r=!0,l=!1;e.hasClass("not-collapsable")&&(r=!1),e.attr("data-acc")&&(l=!0),e.hasClass("collapsed")||(t=!e.find(".ui-accordion-item.active").length||e.find(".ui-accordion-item.active").length>1?i.first():e.find(".ui-accordion-item.active"),o(t,"open")),n.on("click",function(){var e=$(this).closest(".ui-accordion-item");e.hasClass("active")?r&&o(e,"close"):o(e,"open")}),e.data("init",!0)}function formInit(e){e.find(".ui-form-field--required").each(function(){$(this).append('<div class="ui-form-errors"><p class="ui-form-errors__item ui-form-errors__item--required">Обязательное поле</p></div>')}),e.find(".ui-form-field--required").each(function(){$(this).find(".ui-input-placeholder").append(" *")}),e.on("submit",function(o){o.preventDefault();var t=e.attr("data-form-type"),i=formValidator(e.get(0));if(i){var n=new FormData(e.get(0)),a=e.attr("data-thxpopup")||"thx";formTitle&&""!=formTitle||(formTitle="Заявка"),n.append("formTitle",formTitle),n.append("formType",t),$.ajax({type:"POST",url:rootPath+"php/send.php",dataType:"json",processData:!1,contentType:!1,data:n,success:function(){thx(a),clearForm(e)},error:function(e){console.log(e)}})}else e.find(".ui-form-field--error").first().find("input, textarea").focus()}),e.data("init",!0)}function popupsInit(e){e.find(".popup-close-container").prepend('<div class="cross-btn popup-close noselect" />'),e.data("init",!0)}function inputInit(e){var o=e.find("input, textarea"),t=e.closest(".ui-form-field");o.on("focus",function(){e.addClass("active focused")}).on("focusout blur change keyup input",function(){var i=$(this).val();""===i?o.is(":focus")||e.removeClass("active"):(e.addClass("active"),t.removeClass("ui-form-field--error"))}).on("focusout",function(){e.removeClass("focused")}),o.trigger("change"),e.data("init",!0)}function imgInit(){$("img[data-src]").each(function(){var e=$(this);e.attr("src",e.attr("data-src")),e.on("load",function(){e.removeAttr("data-src")})})}function collapseInit(e){var o="ui-collapse",t=e.find("."+o+"-hidden"),i=e.find("."+o+"-trigger"),n=i.find("."+o+"-trigger-text"),a=i.attr("data-closed-text"),s=i.attr("data-opened-text");n.text(a),i.on("click",function(){e.hasClass("active")?(e.removeClass("active"),t.slideUp(400),n.text(a)):(e.addClass("active"),t.slideDown(400),n.text(s))})}function init(){imgInit(),$(".ui-tabs").each(function(){!0!==$(this).data("init")&&tabsInit($(this))}),$(".ui-accordion").each(function(){!0!==$(this).data("init")&&accordionInit($(this))}),$(".popup").each(function(){!0!==$(this).data("init")&&popupsInit($(this))}),$(".ui-input").each(function(){!0!==$(this).data("init")&&inputInit($(this))}),$(".send-form").each(function(){!0!==$(this).data("init")&&formInit($(this))}),$(".ui-collapse").each(function(){!0!==$(this).data("init")&&collapseInit($(this))})}function scrollbarWidth(){var e=$('<div style="width:50px;height:50px;overflow:hidden;position:absolute;top:-200px;left:-200px;"><div style="height:100px;"></div>');$("body").append(e);var o=$("div",e).innerWidth();e.css("overflow-y","scroll");var t=$("div",e).innerWidth();return $(e).remove(),o-t}function defineBarWidth(){var e=parseInt($(".page").height());scrollBarWidth=e>winHeight?scrollbarWidth():0}function scrollLock(e,o){"unlock"==o?($("body").removeClass("body--fixed"),e.css({"padding-right":""})):($("body").addClass("body--fixed"),e.css({"padding-right":scrollBarWidth}))}function menuOpen(){popupOpenedPos=$(window).scrollTop(),$("body").addClass("body--menu-opened"),scrollLock(scrollFixedEl),menuOpened=!0}function menuClose(){$("body").removeClass("body--menu-opened"),scrollLock(scrollFixedEl,"unlock"),device.ios()&&$(window).scrollTop(popupOpenedPos),menuOpened=!1}function popup(e,o,t,i,n){if($("#"+e).length){popupOpenedPos=$(window).scrollTop(),$(".popups-overlay").addClass("active"),$("body").addClass("body--popup-opened"),scrollLock(scrollFixedEl),$(".popup").removeClass("active");var a=$(".popup#"+e);if("request"==e){var s="Оставить заявку",r="Оставьте заявку, и&nbsp;наш специалист свяжется с&nbsp;вами в&nbsp;ближайшее время",l="Оставить заявку";t?a.find(".popup-title__head").html(t):a.find(".popup-title__head").html(s),i?a.find(".popup-title__subtitle").html(i):a.find(".popup-title__subtitle").html(r),n?a.find(".ui-btn--sendform").html(n):a.find(".ui-btn--sendform").html(l),o&&(formTitle=o)}a.scrollTop(0).addClass("active"),popupOpened=!0}}function videoPopup(e,o){if($("#"+e).length){popupOpenedPos=$(window).scrollTop(),$(".popups-overlay").addClass("active"),$("body").addClass("body--popup-opened"),scrollLock(scrollFixedEl),$(".popup").removeClass("active");var t=$(".popup#"+e);t.find(".popup-video").html('<iframe src="'+o+'" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>'),t.scrollTop(0).addClass("active"),popupOpened=!0}}function popupClose(){$(".popups-overlay").removeClass("active"),$(".popup").removeClass("active"),$("body").removeClass("body--popup-opened"),setTimeout(function(){scrollLock(scrollFixedEl,"unlock")},animDuration),device.ios()&&$(window).scrollTop(popupOpenedPos),$(".popup-video").html(""),$(".popup .send-form").each(function(){clearForm($(this))}),popupOpened=!1}function thx(e){$(".popup").removeClass("active"),e||(e="thx"),popup(e),$(".popup .send-form").each(function(){clearForm($(this))})}function changeFormTitle(e){formTitle=e}function clearForm(e){e.find(".ui-form-field--error").removeClass(".ui-form-field--error"),e.find(".ui-form-field").find("input, textarea").val("").trigger("change")}function formValidator(e){var o=$(e),t="ui-form-field--error",i="",n=!0;return o.find(".ui-form-field--required").length&&o.find(".ui-form-field--required").each(function(){var e,o=$(this),a=o.attr("data-field-type");e=o.find("input").length?o.find("input").val():o.find("textarea").val(),o.find(".form-errors__item--type").remove(),e?(o.removeClass(t),o.find(".ui-form-errors__item--required").hide(),"email"==a&&(i="Неверный формат e-mail",/^([a-z0-9_\.-])+@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/i.test(e)?(o.find(".ui-form-errors_item--type").remove(),o.removeClass(t)):(o.find(".ui-form-errors").append('<p class="ui-form-errors__item--type">'+i+"</p>"),o.addClass(t),n=!1)),"phone"==a&&(i="Неверный формат телефона",/[^0-9\+ ()\-]/.test(e)?($(this).find(".ui-form-errors").append('<p class="ui-form-errors__item--type">'+i+"</p>"),o.addClass(t),n=!1):(o.find(".ui-form-errors__item--type").remove(),o.removeClass(t)))):(o.addClass(t),o.find(".ui-form-errors__item--type").remove(),o.find(".ui-form-errors__item--required").show(),n=!1)}),n}var winHeight,scrollOffset=60,popupOpened=!1,popupOpenedPos=0,scrollPos=0,animDuration=200,pageLoaded=!1,formTitle="",scrollFixedEl=$("body");svg4everybody(),$(document).ready(function(){function e(e){return $('[data-scroll-section="'+e+'"]').first().offset().top-scrollOffset}function o(){var o=parseInt(.3*winHeight);i||t.each(function(){var t=$(this),i=t.attr("data-scroll-section"),n=$('[data-scroll-link="'+i+'"].nav-scroll'),a=t.outerHeight(),s=e(i);scrollPos>s-o&&scrollPos<s+a-o?n.parent("li").addClass("active"):n.parent("li").removeClass("active")})}"ontouchstart"in document.documentElement?$("html").addClass("touch"):$("html").addClass("no-touch");var t=$("[data-scroll-section]");winHeight=$(window).height(),scrollPos=$(window).scrollTop(),init(),$(document).on("click",".menu-toggle",function(){menuOpened?menuClose():menuOpen()}),device.desktop(),$(window).on("resize",function(){winHeight=$(window).height(),scrollPos=$(window).scrollTop(),scrollbarWidth(),defineBarWidth(),o(),vhFix(),menuOpened&&menuClose()}),$(window).on("scroll",function(){scrollPos=$(window).scrollTop(),o()}),$(window).trigger("resize").trigger("scroll"),$(document).on("input change paste keyup",'input.phone-number, .send-form .ui-form-field[data-field-type="phone"] input',function(){$(this).val(this.value.replace(/[^0-9\+ ()\-]/,""))}),$(document).on("click",".scrollTo",function(e){e.preventDefault();var o=$(this).attr("data-scrollto-link");if(o){var t=$('[data-scrollto-target="'+o+'"]').not($(this)).offset().top-scrollOffset;$("html, body").animate({scrollTop:t},500)}}),$(document).on("click","[data-popup-open]",function(){popup($(this).attr("data-popup-open"))}),$(document).on("click",".popup-close",function(){popupClose()}),$(document).on("click",".popup",function(e){$(e.target).closest(".popup-content").length||(popupClose(),e.stopPropagation())}),$(document).keypdown(function(e){27==e.which&&popupOpened&&popupClose()});var i=!1;$(".nav-scroll[data-scroll-link]").on("click",function(o){var t=$(this).attr("data-scroll-link"),n=0;$('[data-scroll-section="'+t+'"]').length&&(menuOpened=!1,scrollLock(scrollFixedEl,"unlock"),$(".nav-scroll[data-scroll-link]").closest("li").removeClass("active"),$('.nav-scroll[data-scroll-link="'+t+'"]').closest("li").addClass("active"),i=!0,n=e(t),$("html, body").animate({scrollTop:n},700,function(){i=!1})),o.preventDefault()})}),$(window).on("load",function(){setTimeout(function(){$(".preloader").fadeOut(1e3,function(){$(this).remove()}),$("body").addClass("body--page-loaded"),pageLoaded=!0,$(window).trigger("scroll")},300)});var scrollBarWidth=0,menuOpened=!1;