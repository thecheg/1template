"use strict";function popup(e,t,i,o,a){popupedPos=$(window).scrollTop(),$("html").addClass("html--popuped"),$(".popups-overlay").fadeIn(animDuration),$(".popup").removeClass("active").fadeOut(animDuration);var s=$(".popup#"+e);if("request"==e){i?s.find(".popup_h1").html(i):s.find(".popup_h1").html("Оставить заявку"),o?s.find(".popup_h2").html(o):s.find(".popup_h2").html("Оставьте заявку, и&nbsp;наш специалист свяжется с&nbsp;вами в&nbsp;ближайшее время"),a?s.find(".btn").html(a):s.find(".btn").html("Оставить заявку"),t&&(formTitle=t)}s.addClass("active").fadeIn(animDuration).scrollTop(0),popuped=!0}function videoPopup(e,t){popupedPos=$(window).scrollTop(),$("html").addClass("html--popuped"),$(".popups-overlay").fadeIn(animDuration),$(".popup").removeClass("active").fadeOut(animDuration);var i=$(".popup--video#"+e);i.find(".popup_video").html('<iframe src="'+t+'" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>'),i.addClass("active").fadeIn(animDuration).scrollTop(0),popuped=!0}function popupClose(){$(".popups-overlay").fadeOut(animDuration),$(".popup").removeClass("active").fadeOut(animDuration,function(){$("html").removeClass("html--popuped")}),device.ios()&&$(window).scrollTop(popupedPos),$(".popup_video").html(""),$(".popup").find(".form__field").removeClass("form__field--error"),$(".popup").find(".form__field").find("input, textarea").val("").trigger("change"),popuped=!1}function thx(e){$(".popup").removeClass("active").fadeOut(animDuration),e||(e="thx"),popup(e),$("body").find(".form__field--error").removeClass("form__field--error"),$("body").find("textarea, input").val("").trigger("change")}function changeFormTitle(e){formTitle=e}function formValidator(e){var t=$(e),i=!0;if(t.find(".form__field--required").length&&t.find(".form__field--required").each(function(){var e,t="form__field--error",o=$(this).attr("data-field-type");if(e=$(this).find("input").length?$(this).find("input").val():$(this).find("textarea").val()){if($(this).removeClass(t),$(this).find(".form-errors__item--required").hide(),"email"==o){a="Неверный формат e-mail";/^[\.A-z0-9_\-\+]+[@][A-z0-9_\-]+([.][A-z0-9_\-]+)+[A-z]{1,4}$/.test(e)?($(this).find(".form-errors_item--type").remove(),$(this).removeClass(t)):($(this).find(".form-errors").append('<p class="form-errors__item--type">'+a+"</p>"),$(this).addClass(t),i=!1)}if("phone"==o){var a="Неверный формат номера телефона";/[^0-9\+ ()\-]/.test(e)?($(this).find(".form-errors").append('<p class="form-errors__item--type">'+a+"</p>"),$(this).addClass(t),i=!1):($(this).find(".form-errors__item--type").remove(),$(this).removeClass(t))}}else $(this).addClass(t),$(this).find(".form-errors__item--type").remove(),$(this).find(".form-errors__item--required").show(),i=!1}),1!=i)return!1}var winWidth,winHeight,scrollOffset,popuped=!1,scrollPos=0,animDuration=400,offsetElem=$("header"),popupedPos,formTitle="";$(document).ready(function(){function e(){offsetElem.hasClass("hidden")?offsetElem.hasClass("hidden")&&(scrollOffset=0):scrollOffset=offsetElem.outerHeight()}function t(e,t){var i=e.indexOf(t);i=(e=e.slice(i,e.length)).indexOf(t);var o=e.indexOf("&");o<0&&(o=e.length);var a=e.slice(i+4,o);return d=e.slice(o+1,e.length),a}function i(e){var t=e.attr("href");return $(t).offset().top-scrollOffset}function o(e){var t,o=parseInt($(window).height()/3);for(t=0;t<u.length;t++){var a=$(u[t]),s=i(a);e>s-o&&e<s+o?(u.parent("li").removeClass("active"),a.parent("li").addClass("active")):u.parent("li").removeClass("active")}}if(svg4everybody(),$(".preloader").fadeOut(animDuration,function(){$(this).remove()}),$("a.fancybox").fancybox(),serviceName&&(serviceName+=" – "),winWidth=$(window).width(),winHeight=$(window).height(),scrollPos=$(window).scrollTop(),e(),$("img[data-src]").each(function(){var e=$(this);e.attr("src",e.attr("data-src")),e.on("load",function(){e.removeAttr("data-src")})}),$(window).resize(function(){winWidth=$(window).width(),winHeight=$(window).height(),scrollPos=$(window).scrollTop(),e()}),$(window).scroll(function(){scrollPos=$(window).scrollTop(),e()}),device.desktop());else{var a=scrollPos;$(window).scroll(function(){s()});function s(){$("body").hasClass("body--menu-opened")||(scrollPos>a?offsetElem.addClass("hidden"):scrollPos<a&&offsetElem.removeClass("hidden")),a=scrollPos}}$(".form--validate").each(function(){var e=$(this);e.find(".form__field").each(function(){$(this).append('<div class="form-errors" />')}),e.find(".form__field--required").find(".form-errors").append('<p class="form-errors__item form-errors__item-required">Обязательное поле</p>')}),$(".form--validate").find(".form__field--required").each(function(){$(this).find(".placeholder").append(" *")}),$(".label--input").each(function(){var e=$(this),t=$(this).find("input, textarea"),i=$(this).closest(".form__field");t.on("focus",function(){e.addClass("active focused")}).on("focusout blur change keyup input",function(){""==$(this).val()?t.is(":focus")||e.removeClass("active"):(e.addClass("active"),i.removeClass("form__field--error"))}).on("focusout",function(){e.removeClass("focused")})}),$(".form--enter").find("input, textarea").on("focus",function(){$(this).closest(".form--enter").addClass("focused")}).on("blur",function(){$(this).closest(".form--enter").removeClass("focused")}),$(".form--enter").find("input, textarea").on("focus",function(){var e=$(this).closest(".form--enter"),t=e.find(".btn--enter");$(document).keydown(function(i){e.hasClass("focused")&&13==i.which&&t.trigger("click")})}),$('input[type="number"]').on("input change paste keyup",function(){var e=parseInt($(this).attr("data-max")),t=$(this).val();t.length>e&&$(this).val(t.slice(0,e))}),$('input.input-phone_number, .form-validate .form__field[data-field-type="phone"] input').on("input change paste keyup",function(){$(this).val(this.value.replace(/[^0-9\+ ()\-]/,""))}),$(".scrollTo").on("click",function(e){e.preventDefault();var t=$(this).attr("data-scrollto");if(t){var i=$('[data-scrollto="'+t+'"]').not($(this)).offset().top-scrollOffset;$("html, body").animate({scrollTop:i},500)}}),$(".custom-select").each(function(){var e=$(this),t=e.attr("data-select-title");e.wrap('<div class="select" />');var i=$(this).closest(".select");e.css({position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%",opacity:"0","z-index":"-1"}),!1===device.desktop()&&e.css({"z-index":"3"}),i.append('<div class="trigger">'+t+"</div>").append('<ul class="options" />');var o=i.find(".trigger"),a=i.find("ul.options");!1===device.desktop()&&a.css({visibility:"hidden"});var s=1;e.find("option").each(function(){var e="",t=$(this).text(),o=$(this).val();$(this).attr("data-option",s),$.map(this.attributes,function(t){e=e+" "+t.name+'="'+t.value+'"'}),i.find("ul.options").append('<li data-value="'+o+'" '+e+'">'+t+"</li>"),i.find("ul.options").find('li[data-value="'+o+'"]').removeAttr("value"),s++}),o.on("click touch",function(){var e=$(this).outerHeight(),t=i.offset().top,o=a.outerHeight();$(".wrapper").outerHeight();i.hasClass("active")?i.removeClass("active"):(t+e+o+20>$(window).height()+$(window).scrollTop()?i.addClass("overflowing"):i.removeClass("overflowing"),i.addClass("active"))}),a.find("li").on("click",function(){if(!$(this).hasClass("selected")){var t=$(this).attr("data-option"),a=$(this).text();o.text(a),i.addClass("filled"),i.find("li").removeClass("selected"),$(this).addClass("selected"),i.removeClass("active"),e.find("option:selected").each(function(){this.selected=!1}),e.find('option[data-option="'+t+'"]').attr("selected","selected"),i.addClass("chosen")}i.hasClass("with-input")&&i.find("input").val(a)}),e.on("change",function(){var e=$(this).find("option:selected").attr("data-option");a.find('li[data-option="'+e+'"]').trigger("click")})});var n=document.location.href.split("?params!")[1]||"",r=(n.match(/tab=/g)||[]).length,l=(n.match(/acc=/g)||[]).length;if(r>0)for(var d=n,f=0;f<r;f++){var c=t(d,"tab="),p=$("ul.tabs").find('a[data-tab="'+c+'"]');p.closest("ul.tabs").find("li").removeClass("active"),p.closest("li").addClass("active")}$(".tab-content").hide(),$("ul.tabs").each(function(){($(this).find("li.active").length<1||$(this).find("li.active").length>1)&&($(this).find("li").removeClass("active"),$(this).find("li:first-child").addClass("active"));var e=$(this).find("li.active").find("a").attr("data-tab");$('.tab-content[data-tab="'+e+'"]').show()}),$("ul.tabs").find("a").on("click",function(){if(!$(this).closest("li").hasClass("active")){var e=$(this).attr("data-tab");$(this).closest("ul").find("li").removeClass("active"),$(this).closest("li").addClass("active"),$('.tab-content[data-tab="'+e+'"]').parent().find(".tab-content").hide(),$('.tab-content[data-tab="'+e+'"]').fadeIn(animDuration)}}),l>0&&setTimeout(function(){for(var e=n,i=0;i<l;i++){var o=t(e,"acc="),a=o.indexOf("(scroll)");-1!=a&&(o=o.slice(0,a)),$("ul.accordion").find('li[data-acc="'+o+'"]').find("h6").trigger("click")}},200),$("ul.accordion").not(".collapsed").each(function(){($(this).find("li.active").length<1||$(this).find("li.active").length>1)&&($(this).find("li").removeClass("active"),$(this).find("li").first().addClass("active"))}),$("ul.accordion").find("li").not(".active").each(function(){$(this).find(".panel").hide()}),$("ul.accordion").find("li").find("h6").on("click",function(){var e=$(this).closest("li"),t=$(this).closest("ul").find("li");if(e.hasClass("active"))e.removeClass("active"),t.find(".panel").slideUp(animDuration);else{$(this).closest("ul.accordion").find(".panel").hide();var i=e.offset().top-scrollOffset;$(this).closest("ul.accordion").find("li.active").find(".panel").show(),setTimeout(function(){$("html, body").animate({scrollTop:i},animDuration),t.removeClass("active"),e.addClass("active"),t.find(".panel").slideUp(animDuration),e.find(".panel").slideDown(animDuration)},1)}}),$(document).mouseup(function(e){var t=$(".select.active, .dropdown.active");t.is(e.target)||0!==t.has(e.target).length||t.removeClass("active")}),$("iframe").each(function(){var e=$(this).attr("src"),t="wmode=transparent";if(-1!=e.indexOf("?")){var i=e.split("?"),o=i[1],a=i[0];$(this).attr("src",a+"?"+t+"&"+o)}else $(this).attr("src",e+"?"+t)}),$(".popup__content").each(function(){$(this).prepend('<div class="popup__close noselect" />')}),$(".popup__close").on("click",function(){popupClose()}),$(".popup").on("click",function(e){$(e.target).closest(".popup__content").length||(popupClose(),e.stopPropagation())}),$(document).keydown(function(e){(popuped=!0)&&27==e.which&&popupClose()}),$(".btn--sendform").on("click",function(){if($("body").find("form:not(this)").children(".form__field").removeClass("form__field-error"),refUrl="<br>"+refUrl.toString().replace(/&/g,"<br>"),0!=formValidator($(this).closest("form").get(0))){var e=$(this).closest("form"),t=$('input[name="name"]',e).val()||"",i=$('input[name="phone"]',e).val()||"",o=$('input[name="email"]',e).val()||"",a=$('textarea[name="question"]',e).val()||"",s=$(".btn--sendform",e).attr("data-thxpopup")||"thx",n=$(".btn--sendform",e).attr("data-form-type");formTitle||(formTitle="Заявка"),$.ajax({type:"POST",url:rootPath+"php/send.php",dataType:"json",data:{name:t,phone:i,submit:n,email:o,question:a,formTitle:serviceName+formTitle,referrer:referrer,utm:refUrl,siteName:siteName,emailsArr:emailsArr}}).always(function(){thx(s)})}else $(this).closest(".form--validate").find(".form__field-error").first().find("input, textarea").focus()}),$('a[href^="#"].navScroll').click(function(e){var t=i($(this));$("html, body").animate({scrollTop:t},500),e.preventDefault()});var u=$('a[href^="#"].navScroll');o($(window).scrollTop()),$(window).scroll(function(e){o($(window).scrollTop())})});